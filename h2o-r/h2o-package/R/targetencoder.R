# This file is auto-generated by h2o-3/h2o-bindings/bin/gen_R.py
# Copyright 2016 H2O.ai;  Apache License Version 2.0 (see LICENSE for details) 
#'
# -------------------------- targetencoder -------------------------- #
#' @param x A vector containing the \code{character} names of the predictors in the model.
#' @param blending \code{Logical}. Is blending used ? True if blending is used, false if not. False by default.. Defaults to
#'        FALSE.
#' @param encoded_columns Columnds to encode.
#' @param target_column Target column for the encoding
#' @param blending_parameters Parameters used for blending (if enabled). Blending is to be enabled separaterly using the 'blending'
#'        parameter.
#' @param data_leakage_handling Data leakage handling strategy. Default to None.
#' @param model_id Destination id for this model; auto-generated if not specified.
#' @export
h2o.targetencoder <- function(training_frame, x,
                              blending = FALSE,
                              encoded_columns = NULL,
                              target_column = NULL,
                              blending_parameters = NULL,
                              data_leakage_handling = NULL,
                              model_id = NULL
                              ) 
{
  # Validate required training_frame first and other frame args: should be a valid key or an H2OFrame object
  training_frame <- .validate.H2OFrame(training_frame, required=TRUE)

  # Handle other args
  # Parameter list to send to model builder
  parms <- list()
  parms$training_frame <- training_frame
  if(!missing(x))
    parms$ignored_columns <- .verify_datacols(training_frame, x)$cols_ignore
 if(missing(encoded_columns) && !missing(x)){
     parms$encoded_columns <- x
 }
 parms$response_column <- target_column
  if (!missing(blending))
    parms$blending <- blending
  if (!missing(encoded_columns))
    parms$encoded_columns <- encoded_columns
  if (!missing(target_column))
    parms$target_column <- target_column
  if (!missing(blending_parameters))
    parms$blending_parameters <- blending_parameters
  if (!missing(data_leakage_handling))
    parms$data_leakage_handling <- data_leakage_handling
  if (!missing(model_id))
    parms$model_id <- model_id
  # Error check and build model
  .h2o.modelJob('targetencoder', parms, h2oRestApiVersion = 3) 
}
